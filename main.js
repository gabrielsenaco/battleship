(()=>{var t={757:(t,e,r)=>{t.exports=r(666)},798:function(t,e,r){t=r.nmd(t),function(r,n){"use strict";var o={};r.PubSub=o,function(t){var e={},r=-1;function n(t,e,r){try{t(e,r)}catch(t){setTimeout(function(t){return function(){throw t}}(t),0)}}function o(t,e,r){t(e,r)}function i(t,r,i,a){var u,c=e[r],l=a?o:n;if(Object.prototype.hasOwnProperty.call(e,r))for(u in c)Object.prototype.hasOwnProperty.call(c,u)&&l(c[u],t,i)}function a(t){var r=String(t);return Boolean(Object.prototype.hasOwnProperty.call(e,r)&&function(t){var e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1}(e[r]))}function u(t,e,r,n){var o=function(t,e,r){return function(){var n=String(t),o=n.lastIndexOf(".");for(i(t,t,e,r);-1!==o;)o=(n=n.substr(0,o)).lastIndexOf("."),i(t,n,e,r);i(t,"*",e,r)}}(t="symbol"==typeof t?t.toString():t,e,n);return!!function(t){for(var e=String(t),r=a(e)||a("*"),n=e.lastIndexOf(".");!r&&-1!==n;)n=(e=e.substr(0,n)).lastIndexOf("."),r=a(e);return r}(t)&&(!0===r?o():setTimeout(o,0),!0)}t.publish=function(e,r){return u(e,r,!1,t.immediateExceptions)},t.publishSync=function(e,r){return u(e,r,!0,t.immediateExceptions)},t.subscribe=function(t,n){if("function"!=typeof n)return!1;t="symbol"==typeof t?t.toString():t,Object.prototype.hasOwnProperty.call(e,t)||(e[t]={});var o="uid_"+String(++r);return e[t][o]=n,o},t.subscribeAll=function(e){return t.subscribe("*",e)},t.subscribeOnce=function(e,r){var n=t.subscribe(e,(function(){t.unsubscribe(n),r.apply(this,arguments)}));return t},t.clearAllSubscriptions=function(){e={}},t.clearSubscriptions=function(t){var r;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t)&&delete e[r]},t.countSubscriptions=function(t){var r,n,o=0;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t)){for(n in e[r])o++;break}return o},t.getSubscriptions=function(t){var r,n=[];for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t)&&n.push(r);return n},t.unsubscribe=function(r){var n,o,i,a="string"==typeof r&&(Object.prototype.hasOwnProperty.call(e,r)||function(t){var r;for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&0===r.indexOf(t))return!0;return!1}(r)),u=!a&&"string"==typeof r,c="function"==typeof r,l=!1;if(!a){for(n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(o=e[n],u&&o[r]){delete o[r],l=r;break}if(c)for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&o[i]===r&&(delete o[i],l=!0)}return l}t.clearSubscriptions(r)}}(o),void 0!==t&&t.exports&&(e=t.exports=o),e.PubSub=o,t.exports=e=o}("object"==typeof window&&window||this)},666:t=>{var e=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,i=Object.create(o.prototype),a=new P(n||[]);return i._invoke=function(t,e,r){var n=f;return function(o,i){if(n===d)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return L()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=w(a,r);if(u){if(u===b)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var c=s(t,e,r);if("normal"===c.type){if(n=r.done?p:h,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=p,r.method="throw",r.arg=c.arg)}}}(t,r,a),i}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f="suspendedStart",h="suspendedYield",d="executing",p="completed",b={};function v(){}function y(){}function m(){}var g={};c(g,i,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(I([])));E&&E!==r&&n.call(E,i)&&(g=E);var S=m.prototype=v.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,u){var c=s(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var o;this._invoke=function(t,n){function i(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,w(t,r),"throw"===r.method))return b;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var o=s(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,b;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,b):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function G(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function I(t){if(t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}return{next:L}}function L(){return{value:e,done:!0}}return y.prototype=m,c(S,"constructor",m),c(m,"constructor",y),y.displayName=c(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,c(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},t.awrap=function(t){return{__await:t}},x(O.prototype),c(O.prototype,a,(function(){return this})),t.AsyncIterator=O,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(S),c(S,u,"Generator"),c(S,i,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=I,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(G),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return u.type="throw",u.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,b):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),G(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;G(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:I(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),b}},t}(t.exports);try{regeneratorRuntime=e}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{"use strict";var t=r(798),e=r.n(t),n={SET_PLAYER_OPTION:"SET_PLAYER_OPTION",UPDATE_GAMEBOARD:"UPDATE_GAMEBOARD",SHOW_GAMEBOARD:"SHOW_GAMEBOARD",HIDE_GAMEBOARD:"HIDE_GAMEBOARD",PASS_DEVICE:"PASS_DEVICE",PING_SHOW_GAMEBOARD:"PING_SHOW_GAMEBOARD",PING_HIDE_GAMEBOARD:"PING_HIDE_GAMEBOARD",PING_SETUP_PLAYERS:"PING_SETUP_PLAYERS",SETUP_SHIPS:"SETUP_SHIPS",START_GAME:"START_GAME",START_GAME_CONFIRMATION:"START_GAME_CONFIRMATION",GAME_END:"GAME_END"};function o(){return Math.random()>=.5}function i(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=e.reduce((function(t,e){return t.concat(Object.keys(e))}),[]),o=new Set(n);return e.every((function(t){return o.size===Object.keys(t).length}))}function a(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=document.createElement(t);return e&&(o.className=e),r&&(o.id=r),n&&n.appendChild(o),o}function u(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r>30?null:e&&t(e)?e:u(t,e.parentNode,++r)}var c,l=a("p","hidden","log",document.body);function s(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){s(i,n,o,a,u,"next",t)}function u(t){s(i,n,o,a,u,"throw",t)}a(void 0)}))}}l.addEventListener("click",(function(){return l.classList.add("hidden")})),e().subscribe(n.SEND_LOG,(function(t,e){var r,n;r=e.message,n=e.type||"info",l.textContent=r,l.setAttribute("data-type",n),l.classList.remove("hidden"),clearTimeout(c),c=setTimeout((function(){return l.classList.add("hidden")}),5e3)})),e().subscribe(n.PASS_DEVICE,(function(t,r){!function(t){var r=t.object.getName(),o=a("section","page","pass-device",document.body);a("p","page-text",null,o).textContent="Now it's ".concat(r,"'s turn. Pass the device to him/her."),a("p","page-text",null,o).textContent="It is necessary for the player to confirm by clicking the button below.";var i=a("button","btn page-btn",null,o);i.textContent="Device passed to me",i.addEventListener("click",(function(){o.remove(),e().publishSync(n.PING_SHOW_GAMEBOARD,t)}))}(r)})),e().subscribe(n.GAME_END,(function(t,r){!function(t){var r=a("section","page","game-end",document.body);a("p","trophy",null,r).textContent="ðŸ†",a("p","page-text winner",null,r).textContent="TIE"===t?"There is a TIE!":"The player ".concat(t.getName()," won the game!"),a("p","page-text",null,r).textContent="Want to play again? Click on button bellow";var o=a("button","btn page-btn",null,r);o.textContent="Play again",o.addEventListener("click",(function(){r.remove(),e().publish(n.PING_SETUP_PLAYERS,{})}))}(r)})),e().subscribe(n.START_GAME_CONFIRMATION,(function(t,e){e.started&&document.body.setAttribute("game","started")})),e().subscribe(n.GAME_END,(function(t,e){document.body.setAttribute("game","not started")}));var h=r(757),d=r.n(h);function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function b(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return v(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?v(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var y=function(){var t=e();function e(){for(var t=[],e=0;e<10;e++){for(var r=[],n=0;n<10;n++)r.push({hitted:!1,ship:null});t.push(r)}return t}function r(t,e){if(t<0||t>=10||e>=10||e<0)throw new Error("Array item not found. Insert number in 0..9");return!0}function n(t){var e=t.getLength();return 1===e?0:e-1}function o(e,r){for(var n={default:{x:e,y:r},top:{x:e,y:r-1},bottom:{x:e,y:r+1},left:{x:e-1,y:r},right:{x:e+1,y:r}},o=0,i=Object.values(n);o<i.length;o++){var a=i[o];if(t[a.x]){var u=t[a.x][a.y];if(u&&u.ship)return!1}}return!0}function i(e,i,a){if(r(i,a),!function(e,r,i){for(var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=e.isHorizontal()?r:i,c=n(e),l=u;l<=c+u;l++){try{var s=e.isHorizontal()?t[l-1][i]:t[r][l-1];if(a&&s.ship&&s.ship===e)return!0}catch(t){}if(!(e.isHorizontal()?o(l,i):o(r,l)))return!1}return!0}(e,i,a))throw new Error("Cannot place ship because around is not empty.");if(!function(e,r,o){var i,a=n(e),u=function(t){if(Array.isArray(t))return p(t)}(i=t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(i)||function(t,e){if(t){if("string"==typeof t)return p(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(t,e):void 0}}(i)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}();return!!(e.isHorizontal()?u[r+a]:u[r][o+a])}(e,i,a))throw new Error("Cannot place ship on invalid grid position.");return!0}function a(e,n){return r(e,n),t[e][n]}function u(e){for(var r=[],n=0;n<t.length;n++)for(var o=0;o<t.length;o++){var i=t[n][o].ship;i&&i===e&&r.push({x:n,y:o})}return r}function c(){var e,r=[],n=b(t.flat());try{var o=function(){var t=e.value,n=t.ship;n&&!r.some((function(t){return t.ship===n}))&&r.push(t)};for(n.s();!(e=n.n()).done;)o()}catch(t){n.e(t)}finally{n.f()}return r}return{isAllShipsSunk:function(){var e,r=b(t.flat());try{for(r.s();!(e=r.n()).done;){var n=e.value.ship;if((!n||!n.isSunk())&&n)return!1}}catch(t){r.e(t)}finally{r.f()}return!0},placeShip:function(e,r,o){if(i(e,r,o))for(var a=e.isHorizontal()?r:o,u=n(e),c=a;c<=u+a;c++)e.isHorizontal()?t[c][o].ship=e:t[r][c].ship=e},placeShipPart:function(e,n,o){r(n,o),t[n][o].ship=e},getPosition:a,receiveAttack:function(e,n){r(e,n);var o=t[e][n];o.hitted=!0;var i={hitted:!0,ship:null};if(o.ship){var a=function(t,e,n){return r(e,n),u(t).findIndex((function(t){return t.x===e&&t.y===n}))}(o.ship,e,n);o.ship.hit(a),i.ship=!0}return i.x=e,i.y=n,i},getShipsPoints:c,getFlatGrid:function(){return t.flat()},getNextShipPart:function(t,e,n){if(!t)return null;t.isHorizontal()?e+=1:n+=1;try{r(e,n);var o=a(e,n);return o.ship===t?o:null}catch(t){return null}},getAllShipPartsInGrid:function(){var t,e=[],r=b(c());try{for(r.s();!(t=r.n()).done;){var n=t.value;e.push(u(n.ship))}}catch(t){r.e(t)}finally{r.f()}return e.flat()},getFirstShipPartPosition:function(t){return u(t)[0]},reset:function(){t=e()},hasPlacedAllShips:function(t){return c().length===t},tryPlaceShip:i}},m=function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=o();function o(){for(var t=[],r=0;r<e;r++)t.push(!1);return t}function i(t){if(t<0)throw new Error("Invalid hit position number. Must be 0 or more");if(t>e-1)throw new Error("Invalid hit position. This number overflow the ship length.");return n[t]=!0,!0}function a(){return t}function u(){return s()===e}function c(){return n.length}function l(){return n}function s(){return n.filter((function(t){return t})).length}function f(){return r}return{getLength:c,isHorizontal:f,getParts:l,hit:i,getHits:s,isSunk:u,getName:a}};function g(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return A(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function E(){return Math.round(9*Math.random())}var S=function(t){var e=y(),r=y();function n(){return r}return{attack:function(t,r,n){t.ship&&e.placeShipPart(m(1),r,n),e.receiveAttack(r,n)},getGameboard:n,getEnemyGameboard:function(){return e},getName:function(){return t},buildGameboardScheme:function(t){var e,r=g(t);try{for(r.s();!(e=r.n()).done;)for(var i=e.value,a=o(),u=E(),c=E(),l=m(i.name,i.length,a);;)try{n().placeShip(l,u,c);break}catch(t){u=E(),c=E()}}catch(t){r.e(t)}finally{r.f()}}}},x=function(t){var e=S(t),r=e.attack,n=e.getGameboard,o=e.getEnemyGameboard,i=e.getName,a=e.buildGameboardScheme;function u(){for(var t={},e=null;!e||e.hitted;)t={x:E(),y:E()},e=o().getPosition(t.x,t.y);return t}function c(t,e,r,n){var i,a=[],u=g(function(t,e,r,n){var o=[];return n&&o.push([{x:t+1,y:e},{x:t-1,y:e}]),r&&o.push([{x:t,y:e+1},{x:t,y:e-1}]),o.flat()}(t,e,r,n));try{for(u.s();!(i=u.n()).done;){var c=i.value;if(c.x>=0&&c.x<10&&c.y<10&&c.y>=0){var l=o().getPosition(c.x,c.y);l&&a.push({x:c.x,y:c.y,hitted:l.hitted,ship:l.ship})}}}catch(t){u.e(t)}finally{u.f()}return a}return{attack:r,getGameboard:n,getEnemyGameboard:o,getName:i,buildGameboardScheme:a,betterAttack:function(){return function(){try{var t,e=o().getAllShipPartsInGrid(),r=[],n=g(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,a=(s=i.x,f=i.y,h=void 0,h=function(t,e){var r=c(t,e,!0,!0),n=r.filter((function(t){return t.y===e&&t.ship})),o=r.filter((function(e){return e.x===t&&e.ship}));return o.length>n.length?{horizontal:!0,vertical:!1}:o.length<n.length?{horizontal:!1,vertical:!0}:{horizontal:!0,vertical:!0}}(s,f),c(s,f,h.horizontal,h.vertical).filter((function(t){return!t.hitted})));r.push(a)}}catch(t){n.e(t)}finally{n.f()}var l=r.sort((function(t,e){return t.length<e.length?1:-1}))[0];if(l&&l.length>0)return l[0]}catch(t){return u()}var s,f,h;return u()}()}}},O=x(),w=S();function _(t){return!!t&&i(t,O)}function G(t,e,r){return"vertical"===r?t:e}function P(t){return G("bg-ship_bottom_vertical","bg-ship_bottom_horizontal",t)}function I(t){return G("bg-ship_front_vertical","bg-ship_front_horizontal",t)}function L(t,e,r,n){var o;t.className="ship-component",o=0===r?I(n):r+1===e?P(n):"bg-ship_body",t.classList.add(o)}var D=["A","B","C","D","E","F","G","H","I","J"];function T(t,e,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o="grid-container",i=a("div",o+=t?" big":"",null),u=a("div","grid",null,i),c=a("div","grid-numbers-index",null,i),l=a("div","grid-letters-index",null,i),s=1;s<=10;s++){var f=a("p","grid-item grid-item-index",null,c);f.textContent=s;var h=a("p","grid-item grid-item-index",null,l);h.textContent="".concat(D[s-1])}for(var d=0;d<10;d++)for(var p=0;p<10;p++){var b=a("div","grid-item",null,u);b.setAttribute("data-x",d),b.setAttribute("data-y",p)}if(n){var v=R(i,e,r);return{section:v,container:i,grid:u}}return{container:i,grid:u}}function N(t,e,r,n){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=T(t,e,n,o);return j(i,r),i}function j(t,e){t&&e&&e.getFlatGrid().forEach((function(r,n){var o=t.grid.children[n];if(!r.hitted||(o.classList.add("hitted"),r.ship)){var i=parseInt(o.getAttribute("data-x")),a=parseInt(o.getAttribute("data-y"));if(r.ship){if(o.classList.add("ship-component"),r.hitted)return void o.classList.add("bg-ship_hitted");var u=e.getNextShipPart(r.ship,i,a),c=e.getFirstShipPartPosition(r.ship),l=r.ship.isHorizontal()?"horizontal":"vertical";i===c.x&&a===c.y?o.classList.add(I(l)):u?o.classList.add("bg-ship_body"):o.classList.add(P(l))}}else o.classList.add("bg-hitted")}))}function M(t){var e=t.getAttribute("data-x"),r=t.getAttribute("data-y");if(e&&r)return{x:e=parseInt(e),y:r=parseInt(r)}}function R(t,e,r){var n,o="gameboard-section ",i=a("section",o+=e?"target":"owner",null,((n=document.getElementById("gameboards"))||(n=a("main",null,"gameboards",document.body)),n));return a("p","gameboard-title",null,i).textContent=e?"Target Gameboard":"".concat(r+","||0," Your Gameboard"),e&&t.classList.add("big"),i.appendChild(t),i}e().subscribe(n.UPDATE_GAMEBOARD,(function(t,e){var r=e.gameboard;j(e.gameboardDOM,r)})),e().subscribe(n.SHOW_GAMEBOARD,(function(t,e){e&&e.section.classList.remove("hidden")})),e().subscribe(n.HIDE_GAMEBOARD,(function(t,e,r){e&&e.section.classList.add("hidden")})),e().subscribe(n.PING_SHOW_GAMEBOARD,(function(t,r){r.bot||e().publishSync(n.SHOW_GAMEBOARD,r.gameboardDOM),e().publishSync(n.SHOW_GAMEBOARD,r.enemyGameboardDOM)})),e().subscribe(n.PING_HIDE_GAMEBOARD,(function(t,r){e().publishSync(n.HIDE_GAMEBOARD,r.gameboardDOM),e().publishSync(n.HIDE_GAMEBOARD,r.enemyGameboardDOM)}));var k=function(t,e){var r,n=N(!1,!0,t.getEnemyGameboard(),null);return e||(r=N(!1,!1,t.getGameboard(),t.getName()),n.grid.addEventListener("click",C.bind(event,t))),{object:t,bot:e,gameboardDOM:r,enemyGameboardDOM:n}};function C(t,r){var o=r.target;if(o.classList.contains("hitted"))e().publish(n.SEND_LOG,{message:"You have already selected this position, please select another position.",type:"error"});else if(o.hasAttribute("data-x")&&o.hasAttribute("data-y")){var i=parseInt(o.getAttribute("data-x")),a=parseInt(o.getAttribute("data-y"));e().publishSync(n.SET_PLAYER_OPTION,{x:i,y:a,object:t})}}var B={x:null,y:null,object:null};function H(){B={x:null,y:null,object:null}}function U(t){return z.apply(this,arguments)}function z(){return(z=f(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){!function r(){H(),setTimeout((function(){if(B.object&&null!==B.y&&null!==B.x){if(B.object!==e)return r();var n=B;return H(),t(n)}return r()}),100)}()})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function F(t,e,r,n){return W.apply(this,arguments)}function W(){return(W=f(d().mark((function t(r,i,a,u){var c,l,s,f,h,p;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a||(a=o()?r:i),c=a===r?i:r,0===u?e().publish(n.SEND_LOG,{message:"Game staterd! ".concat(c.object.getName()," starts"),type:"success"}):e().publish(n.SEND_LOG,{message:"Now it's ".concat(c.object.getName(),"'s turn")}),V(c,a)&&e().publishSync(n.PING_SHOW_GAMEBOARD,c),e().publishSync(n.PING_HIDE_GAMEBOARD,a),u>0&&K(c,a),!c.bot){t.next=11;break}s=c.object.betterAttack(),f=s.x,h=s.y,l={x:f,y:h,object:c},t.next=14;break;case 11:return t.next=13,U(c.object);case 13:l=t.sent;case 14:if($(c,a,l),J(c,a),!(p=q(r.object,i.object))){t.next=20;break}return e().publish(n.GAME_END,p),t.abrupt("return");case 20:a=c,setTimeout((function(){return F(r,i,a,++u)}),1500);case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function q(t,e){var r=t.getGameboard().isAllShipsSunk(),n=e.getGameboard().isAllShipsSunk();return r&&n?"TIE":r?e:n?t:null}function V(t,e){return t.bot||e.bot}function $(t,r,o){var i=r.object.getGameboard().receiveAttack(o.x,o.y);i.ship&&i.hitted&&e().publish(n.SEND_LOG,{message:"You attacked a part of the ship, let's destroy this ship!",type:"success"}),t.object.attack(i,i.x,i.y)}function J(t,r){e().publish(n.UPDATE_GAMEBOARD,{gameboard:r.object.getGameboard(),gameboardDOM:r.gameboardDOM}),e().publish(n.UPDATE_GAMEBOARD,{gameboard:t.object.getEnemyGameboard(),gameboardDOM:t.enemyGameboardDOM})}function K(t,r,o){V(t,r)||e().publishSync(n.PASS_DEVICE,t)}e().subscribe(n.SET_PLAYER_OPTION,(function(t,e){B=e})),e().subscribe(n.START_GAME,(function(t,r){if(2!==r.length)throw new Error("Invalid player length. It only takes two players.");var o,a,u=[],c=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Y(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Y(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}(r);try{for(c.s();!(o=c.n()).done;){var l=o.value;if(!l)throw new Error("Cannot use player with falsy value.");var s=_(l),f=!!(a=l)&&i(a,w);if(!s&&!f)throw new Error("Invalid player type.");var h=l.getGameboard();if(!h)throw new Error("Invalid Gameboard type.");if(5!==h.getShipsPoints().length)throw new Error("Invalid Ships length. Required: 5 differents ships");var d=k(l,s);u.push(d)}}catch(t){c.e(t)}finally{c.f()}e().publish(n.START_GAME_CONFIRMATION,{started:!0}),F(u[0],u[1],null,0)}));function Q(t){for(var r,o=t.target.elements,i=[],a=0,u=[{name:o["player-1-name"].value,bot:o["player-1-bot"].checked},{name:o["player-2-name"].value,bot:o["player-2-bot"].checked}];a<u.length;a++){var c=u[a];i.push((r=c.name,(c.bot?x:S)(r)))}e().publish(n.SETUP_SHIPS,i),t.preventDefault(),t.target.remove()}e().subscribe(n.PING_SETUP_PLAYERS,(function(){var t,e,r;t=Q,Array.from(document.querySelectorAll("#setup-players")).forEach((function(t){return t.remove()})),(r=document.getElementById("gameboards"))&&r.remove(),e=a("form",null,"setup-players",null),document.body.insertBefore(e,document.body.children[0].nextElementSibling||document.body.children[0]),function(t){a("h2","title",null,t).textContent="Players";for(var e=a("ol",null,null,t),r=1;r<=2;r++){var n=a("li",null,null,e),o="player-".concat(r,"-name"),i="player-".concat(r,"-bot"),u=a("label","player-label",null,n);u.setAttribute("for",o),u.textContent="Username";var c=a("input",null,null,n);c.setAttribute("type","text"),c.setAttribute("name",o),c.setAttribute("id",o),c.setAttribute("placeholder","Insert player name here."),c.setAttribute("required","");var l=a("label",null,null,n);l.setAttribute("for",i),l.textContent="Bot";var s=a("input",null,null,l);s.setAttribute("type","checkbox"),s.setAttribute("name",i),s.setAttribute("id",i)}}(e),function(t){a("h3","subtitle",null,t).textContent="Start game";var e=a("button","btn confirm-form",null,t);e.setAttribute("type","submit"),e.textContent="Start game"}(e),e.addEventListener("submit",t)}));var X=[];function Z(t,e){X.push({name:t,length:e})}function tt(){return X}function et(t,r){return 2!==r.length?(e().publish(n.PING_SETUP_PLAYERS,{}),!1):!!t||(e().publish(n.START_GAME,r),!1)}function rt(t,r,o){t.getGameboard().hasPlacedAllShips(tt().length)?(it().remove(),et(r.filter((function(t){return!t.getGameboard().hasPlacedAllShips(tt().length)}))[0],r)&&e().publish(n.SETUP_SHIPS,r)):e().publish(n.SEND_LOG,{message:"You need to place all ships to continue. Hint: clicking on Random button, will setup a random gameboard scheme for you",type:"error"})}function nt(t,e,r){t.getGameboard().reset(),t.buildGameboardScheme(tt());var n=it(),o=at();Array.from(o.children).forEach((function(t){return t.remove()})),vt(n,t)}function ot(t,e,r){var n=at(),o=n.getAttribute("data-orientation");o="vertical"===o?"horizontal":"vertical",n.setAttribute("data-orientation",o),function(t){var e=document.getElementById("ships");Array.from(e.children).forEach((function(e){var r=parseInt(e.getAttribute("data-length"));Array.from(e.children).forEach((function(e,n){return L(e,r,n,t)}))}))}(o)}function it(){return document.getElementById("ships-setup")}function at(){return document.getElementById("ships")}function ut(){var t=at();if(t)return t.getAttribute("data-orientation")}function ct(t,e){t.getGameboard().reset();var r=it();vt(r,t),yt(r,ut())}Z("Carrier",5),Z("Battleship",4),Z("Cruiser",3),Z("Submarine",3),Z("Destroyer",2),e().subscribe(n.SETUP_SHIPS,(function t(r,o){var i=o.filter((function(t){return!t.getGameboard().hasPlacedAllShips(tt().length)})),a=i[0];if(_(a))return a.buildGameboardScheme(tt()),t(r,o);if(et(a,o)){e().publish(n.SEND_LOG,{message:"Now it's time for player ".concat(a.getName()," to build his board scheme.")});var u=i.length>1;At(a,o,u)}}));var lt=function(t,e,r,n){return{name:t,length:e,orientation:r,id:n}};function st(t){try{var e=function(t){var e=t.getData("orientation"),r=parseInt(t.getData("length")),n=t.getData("name"),o=parseInt(t.getData("id"));return lt(n,r,e,o)}(t);return{ship:m(e.name,e.length,"horizontal"===e.orientation),data:e}}catch(t){return t}}function ft(t){var e=t.dataTransfer,r=u((function(t){return t.classList.contains("ship")}),t.target);if(r){var n=ut(),o=r.getAttribute("data-name"),i=parseInt(r.getAttribute("data-length")),a=parseInt(r.getAttribute("data-id")),c=lt(o,i,n,a);e.setDragImage(r,0,10),function(t,e){for(var r=0,n=Object.keys(e);r<n.length;r++){var o=n[r],i=e[o];t.setData(o,i)}}(e,c)}}function ht(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.classList.add("drag-hover"),e&&t.classList.add("error")}function dt(t,e){var r=e.dataTransfer;e.preventDefault();var n=e.target,o=M(n),i=o.x,a=o.y;try{var u=st(r).ship;t.getGameboard().tryPlaceShip(u,i,a),ht(n)}catch(t){ht(n,!0),r.dropEffect="none"}}function pt(t){t.target.classList.remove("drag-hover","error")}function bt(t,r){var o=r.dataTransfer,i=M(r.target),a=i.x,u=i.y;try{var c=st(o),l=c.ship,s=c.data;t.getGameboard().placeShip(l,a,u),vt(document.getElementById("ships-setup"),t);var f=document.querySelector(".ship[data-id='".concat(s.id,"']"));f&&f.remove()}catch(t){e().publish(n.SEND_LOG,{message:"Error found: ".concat(t.message),type:"error"})}}function vt(t,e){var r=t.querySelector(".grid-container");r&&r.remove();var n=N(!0,!1,e.getGameboard(),null,!1);return t.appendChild(n.container),n.grid.addEventListener("drop",bt.bind(event,e)),n.grid.addEventListener("dragover",dt.bind(event,e)),n.grid.addEventListener("dragleave",pt),n}function yt(t,e){var r=document.getElementById("ships-container");r&&r.remove();var n=a("div",null,"ships-container",t),o=a("div",null,"ships",n);o.setAttribute("data-orientation",e),tt().forEach((function(t,r){return function(t,e,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=a("div","ship",null,r);i.setAttribute("draggable","true"),i.setAttribute("data-length",e),i.setAttribute("data-id",o),i.setAttribute("data-name",t),i.addEventListener("dragstart",ft);for(var u=0;u<e;u++)L(a("div","ship-component",null,i),e,u,n)}(t.name,t.length,o,e,r)}))}function mt(t,e,r){var n=a("div",null,"action-button-container",t),o=a("button","btn",null,n),i=a("button","btn",null,n),u=a("button","btn",null,n);o.textContent="Rotate",i.textContent="Random",u.textContent="Reset",o.addEventListener("click",ot.bind(event,e,r)),i.addEventListener("click",nt.bind(event,e,r)),u.addEventListener("click",ct.bind(event,e))}function gt(t,e,r,n){var o=a("button","btn start-game-btn confirm-form",null,t);o.textContent=n?"Next setup":"Start game",o.addEventListener("click",rt.bind(event,e,r))}var At=function(t,e,r){var n;(function(t,e){a("h2","title",null,t).textContent="".concat(e.getName(),", place your ships")})(n=a("main",null,"ships-setup",document.body),t),yt(n,"horizontal"),mt(n,t,e),vt(n,t),function(t,e){a("h3","start-title subtitle",null,t).textContent=e?"Start next setup":"Start game"}(n,r),gt(n,t,e,r)};e().publish(n.PING_SETUP_PLAYERS,{})})()})();